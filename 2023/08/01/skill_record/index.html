
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  
    <title>一些开发工具的使用随手记 | Blog of YQ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Yuanqing Zhu">
    

    
    <meta name="description" content="记录工作中使用一些工具的基础操作">
<meta name="keywords" content="踩坑">
<meta property="og:type" content="article">
<meta property="og:title" content="一些开发工具的使用随手记">
<meta property="og:url" content="http://yoursite.com/2023/08/01/skill_record/index.html">
<meta property="og:site_name" content="Blog of YQ">
<meta property="og:description" content="记录工作中使用一些工具的基础操作">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/use-pycharm-connect-server/1.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/use-pycharm-connect-server/2.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/use-pycharm-connect-server/3.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/use-pycharm-connect-server/4.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/1.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/2.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/3.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/4.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/5.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/6.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/ElasticSearch踩坑/7.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/stanza_1.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/stanza_2.png">
<meta property="og:image" content="http://yoursite.com/2023/08/01/skill_record/MongoDB踩坑/1.png">
<meta property="og:updated_time" content="2023-08-25T06:09:16.951Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一些开发工具的使用随手记">
<meta name="twitter:description" content="记录工作中使用一些工具的基础操作">
<meta name="twitter:image" content="http://yoursite.com/2023/08/01/skill_record/use-pycharm-connect-server/1.png">

    
    <link rel="alternative" href="atom.xml" title="Blog of YQ" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/icon.ico">
    
    
    <link rel="apple-touch-icon" href="//img/IMG_8752.JPG">
    <link rel="apple-touch-icon-precomposed" href="//img/IMG_8752.JPG">
    
    <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
</html>
  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Blog of YQ">Blog of YQ</a></h1>
				<h2 class="blog-motto">this is subtitle :)</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索">
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</ul></nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope="" itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2023/08/01/skill_record/" title="一些开发工具的使用随手记" itemprop="url">一些开发工具的使用随手记</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Yuanqing Zhu" target="_blank" itemprop="author">Yuanqing Zhu</a>
		
  </p><p class="article-time">
    <time datetime="2023-07-31T16:00:00.000Z" itemprop="datePublished"> 发表于 2023-08-01</time>
    
  </p>
</header>
	<div class="article-content">
		
		<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ol>
<li><a href="#server_jupyter">服务器配置jupyter notebook</a></li>
<li><a href="#server_root">服务器添加root权限</a></li>
<li><a href="#server_ssh">服务器添加ssh链接gitlab</a></li>
<li><a href="#server_pip">服务器修改pip&amp;conda源</a></li>
<li><a href="#server_pycharm">使用pycharm链接服务器</a></li>
<li><a href="#git">Git操作三板斧</a></li>
<li><a href="#corenlp">StanfordCoreNLP工具启动命令</a></li>
<li><a href="#ES_try">ElasticSearch踩坑</a></li>
<li><a href="#docker_es">Docker安装ES</a></li>
<li><a href="#server_docker_brat">服务器通过docker部署brat</a></li>
<li><a href="#docker">Docker使用速成</a></li>
<li><a href="#stanza">stanza踩坑</a></li>
<li><a href="#mongodb">MongoDB踩坑</a></li>
<li><a href="#paddle">paddle框架踩坑</a></li>
</ol>
<hr>
<h1 id="服务器配置jupyter-notebook"><a href="#服务器配置jupyter-notebook" class="headerlink" title="服务器配置jupyter notebook"></a><span id="server_jupyter">服务器配置jupyter notebook</span></h1><p><br></p>
<h4 id="如何在服务器启动jupyter服务"><a href="#如何在服务器启动jupyter服务" class="headerlink" title="如何在服务器启动jupyter服务"></a>如何在服务器启动jupyter服务</h4><p>1.生成配置文件</p>
<p><code>jupyter notebook --generate-config</code></p>
<p>2.生成密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ipython</span><br><span class="line">In [1]: from notebook.auth import passwd</span><br><span class="line"></span><br><span class="line">In [2]: passwd()</span><br><span class="line">Enter password:</span><br><span class="line">Verify password:</span><br><span class="line">Out[2]: &apos;sha1:cd723d3e4b0a:e5ca450bbedb63511c78989ea16b8d26941227fb&apos;</span><br></pre></td></tr></table></figure>
<p>3.修改配置文件</p>
<p><code>vim ~/.jupyter/jupyter_notebook_config.py</code></p>
<p>4.启动jupyter</p>
<p><br></p>
<h4 id="如何将虚拟环境解释器添加到Jupyter中"><a href="#如何将虚拟环境解释器添加到Jupyter中" class="headerlink" title="如何将虚拟环境解释器添加到Jupyter中"></a>如何将虚拟环境解释器添加到Jupyter中</h4><ol>
<li><p>激活环境</p>
</li>
<li><p>安装支持虚拟环境的插件nb_conda<code>conda install nb_conda</code></p>
</li>
</ol>
<p>或者可以直接为虚拟环境安装ipykernel包。即：<code>conda install -n myproject ipykernel</code></p>
<p>注： ipykernel比较重要</p>
<p>解决：<code>python -m ipykernel install --user --name 环境名称 --display-name &quot;显示的名称&quot;</code></p>
<h1 id="服务器添加root权限"><a href="#服务器添加root权限" class="headerlink" title="服务器添加root权限"></a><span id="server_root">服务器添加root权限</span></h1><ol>
<li>增加一个账号的ssh登陆权限<br><code>sudo /root/join_domain_linux/ssh_AllowUser.sh add &lt;domain-user-name&gt;</code></li>
<li>去掉一个域账号的ssh登陆权限<br><code>sudo /root/join_domain_linux/ssh_AllowUser.sh del &lt;domain-user-name&gt;</code></li>
<li>增加sudo执行root命令<br><code>sudo /root/join_domain_linux/sudo_nopwd_User.sh add &lt;domain-user-name&gt;</code></li>
<li>去掉一个域账号的sudo执行root命令<br><code>sudo /root/join_domain_linux/sudo_nopwd_User.sh del &lt;domain-user-name&gt;</code></li>
</ol>
<details><summary>附：ssh_AllowUser.sh</summary>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">@!/bin/sh</span><br><span class="line"></span><br><span class="line">action=$1</span><br><span class="line">user=$2</span><br><span class="line"></span><br><span class="line">if [ $# -ne 2 ];then</span><br><span class="line">        echo -e &quot;Usage: ./ssh_AllowUser.sh &lt; add | del &gt; [-u | -g] &lt; username &gt; \n &quot;</span><br><span class="line">        echo -e &quot;example(add) : ./ssh_AllowUser.sh add -u testUser&quot;</span><br><span class="line">        echo -e &quot;example(del) : ./ssh_AllowUser.sh del -u testUser&quot;</span><br><span class="line">        exit 8</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [`echo $user | grep @xx.com` == &apos;&apos;]; then</span><br><span class="line">        user=$user&apos;@xx.com&apos;</span><br><span class="line">else </span><br><span class="line">        user=$user</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">oldline=`cat /etc/sssd/sssd.conf | grep simple_allow_users`</span><br><span class="line">if [ $action == &apos;add&apos; ] ;then</span><br><span class="line">        if [ $user == &apos;root&apos; ] ;then</span><br><span class="line">                sed -i &quot;s/^PermitRootLogin .*/PermitRootLogin yes/g&quot; /etc/ssh/sshd_config</span><br><span class="line">		service sshd restart &gt; /dev/null</span><br><span class="line">	else</span><br><span class="line">	    echo &quot;AllowUsers $user&quot;</span><br><span class="line">		if echo $oldline | grep &quot;\b$user\b&quot; &gt;/dev/null ;then </span><br><span class="line">                        echo &quot;$user already exise&quot; </span><br><span class="line">                else</span><br><span class="line">                        newline=&quot;$oldline, $user&quot; </span><br><span class="line">			sed -i &quot;s/$oldline/$newline/&quot; /etc/sssd/sssd.conf</span><br><span class="line">			service sssd restart &gt; /dev/null</span><br><span class="line">                fi </span><br><span class="line"></span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line">elif [ $action == &apos;del&apos; ] ; then</span><br><span class="line">        if [ $user == &apos;root&apos; ] ;then</span><br><span class="line">                sed -i &quot;s/#PermitRootLogin .*/PermitRootLogin no/g&quot; /etc/ssh/sshd_config</span><br><span class="line">                sed -i &quot;s/^PermitRootLogin .*/PermitRootLogin no/g&quot; /etc/ssh/sshd_config</span><br><span class="line">        	service sshd restart &gt; /dev/null 2&gt;&amp;1 </span><br><span class="line">	else </span><br><span class="line">		newline=`echo $oldline | sed &quot;s/, $user//&quot;`</span><br><span class="line">		sed -i &quot;s/$oldline/$newline/&quot; /etc/sssd/sssd.conf</span><br><span class="line">		service sssd restart &gt; /dev/null</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">        echo &quot;\$1 arg : only &apos;add&apos; or &apos;del&apos; can be entered&quot;</span><br><span class="line">        exit 8</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

</details>


<details><summary>附：sudo_nopwd_User.sh</summary>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">@!/bin/sh</span><br><span class="line"></span><br><span class="line">if [ $# == 2 ]</span><br><span class="line">then</span><br><span class="line">	action=$1</span><br><span class="line">	action_type=&apos;-u&apos;</span><br><span class="line">	name=$2</span><br><span class="line">else</span><br><span class="line">	action=$1</span><br><span class="line">	action_type=$2</span><br><span class="line">	name=&quot;$3 $4&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ $# -gt 4 ];then</span><br><span class="line">        echo -e &quot;Usage: ./sudo_nopwd_User.sh &lt; add | del &gt; [-u|-g] [&lt; username &gt;|&lt; groupname &gt;] \n &quot;</span><br><span class="line">        echo &quot;example(add) : ./sudo_nopwd_User.sh add  -u testUser&quot;</span><br><span class="line">        echo -e &quot;example(del) : ./sudo_nopwd_User.sh del -u testUser\n&quot;</span><br><span class="line">        echo &quot;example(add) : ./sudo_nopwd_User.sh add  -g testGroup&quot;</span><br><span class="line">        echo &quot;example(add) : ./sudo_nopwd_User.sh del  -g testGroup&quot;</span><br><span class="line">        exit 8</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">oldline=`cat /etc/sudoers  | grep &apos;$name&apos;`</span><br><span class="line"></span><br><span class="line">if [ $action == &apos;add&apos; ] ;then</span><br><span class="line">	name=$(echo $name)</span><br><span class="line">	if [ $action_type == &apos;-u&apos; ];then</span><br><span class="line">		if grep &quot;$name  ALL=(ALL)       NOPASSWD:ALL&quot; /etc/sudoers ; then</span><br><span class="line">			echo &quot;$name already exise&quot;</span><br><span class="line">		else</span><br><span class="line">			echo &quot;$name  ALL=(ALL)       NOPASSWD:ALL&quot; &gt;&gt; /etc/sudoers</span><br><span class="line">			echo &quot;success&quot;</span><br><span class="line">		fi</span><br><span class="line">	fi</span><br><span class="line">	if [ $action_type == &apos;-g&apos; ];then</span><br><span class="line">		name=$(echo $name)</span><br><span class="line">		name=$&#123;name// /\\x20&#125; # 将组中可能出现的空格转义</span><br><span class="line">		name=$&#123;name//\\/\\\\&#125; # 将可能出现的\转义</span><br><span class="line">		if grep &quot;%$name  ALL=(ALL)       NOPASSWD:ALL&quot; /etc/sudoers ; then</span><br><span class="line">			echo &quot;%$name already exise&quot;</span><br><span class="line">		else</span><br><span class="line">			echo &quot;%$name  ALL=(ALL)       NOPASSWD:ALL&quot; &gt;&gt; /etc/sudoers</span><br><span class="line">			echo &quot;success&quot;</span><br><span class="line">		fi</span><br><span class="line">	fi</span><br><span class="line"></span><br><span class="line">elif [ $action == &apos;del&apos; ] ; then </span><br><span class="line">	sed -i &quot;/$name/d&quot; /etc/sudoers</span><br><span class="line">	echo &quot;success&quot;</span><br><span class="line"></span><br><span class="line">else </span><br><span class="line">        echo &quot;\$1 arg : only &apos;add&apos; or &apos;del&apos; can be entered&quot;</span><br><span class="line">        exit 8</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

</details>

<h1 id="服务器添加ssh链接gitlab"><a href="#服务器添加ssh链接gitlab" class="headerlink" title="服务器添加ssh链接gitlab"></a><span id="server_ssh">服务器添加ssh链接gitlab</span></h1><h4 id="step-1"><a href="#step-1" class="headerlink" title="step 1"></a>step 1</h4><p><code>ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot;</code></p>
<h4 id="step-2"><a href="#step-2" class="headerlink" title="step 2"></a>step 2</h4><p>复制<strong>id_rsa.pub</strong>的所有内容</p>
<h4 id="step-3"><a href="#step-3" class="headerlink" title="step 3"></a>step 3</h4><p>去gitlab添加</p>
<p><strong>神秘代码：</strong><code>git pull origin service/xxx_xxx</code></p>
<h1 id="服务器修改pip-amp-conda源"><a href="#服务器修改pip-amp-conda源" class="headerlink" title="服务器修改pip&amp;conda源"></a><span id="server_pip">服务器修改pip&amp;conda源</span></h1><h4 id="pip源"><a href="#pip源" class="headerlink" title="pip源"></a>pip源</h4><p>linux下，修改 ~/.pip/pip.conf (没有就创建一个)， 修改 index-url至tsinghua，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>
<h4 id="codna源"><a href="#codna源" class="headerlink" title="codna源"></a>codna源</h4><p>将以上配置文件写在~/.condarc中<br>vim ~/.condarc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</span><br><span class="line">ssl_verify: true</span><br></pre></td></tr></table></figure>
<h1 id="使用pycharm链接服务器"><a href="#使用pycharm链接服务器" class="headerlink" title="使用pycharm链接服务器"></a><span id="server_pycharm">使用pycharm链接服务器</span></h1><h3 id="Step1-按图中标注选择”Automatic-Upload”，这样可以每次使用Ctrl-s保存的时候自动上传到服务器。然后点击”Configuration”进行配置"><a href="#Step1-按图中标注选择”Automatic-Upload”，这样可以每次使用Ctrl-s保存的时候自动上传到服务器。然后点击”Configuration”进行配置" class="headerlink" title="Step1. 按图中标注选择”Automatic Upload”，这样可以每次使用Ctrl+s保存的时候自动上传到服务器。然后点击”Configuration”进行配置"></a>Step1. 按图中标注选择”Automatic Upload”，这样可以每次使用<code>Ctrl+s</code>保存的时候自动上传到服务器。然后点击”Configuration”进行配置</h3><p><img src="/2023/08/01/skill_record/use-pycharm-connect-server/1.png" alt="image"></p>
<h3 id="Step2-按图所示，增加一个配置"><a href="#Step2-按图所示，增加一个配置" class="headerlink" title="Step2. 按图所示，增加一个配置"></a>Step2. 按图所示，增加一个配置</h3><p><img src="/2023/08/01/skill_record/use-pycharm-connect-server/2.png" alt="image"></p>
<h3 id="Step3-这里”SFTP-host”填写服务器ip地址，然后填写一些信息"><a href="#Step3-这里”SFTP-host”填写服务器ip地址，然后填写一些信息" class="headerlink" title="Step3. 这里”SFTP host”填写服务器ip地址，然后填写一些信息"></a>Step3. 这里”SFTP host”填写服务器ip地址，然后填写一些信息</h3><p><img src="/2023/08/01/skill_record/use-pycharm-connect-server/3.png" alt="image"></p>
<h3 id="Step4-注意这里部分的配置，这里是确定代码同步到服务器的目录结构，点击最右侧”…”直接在弹窗中选择即可。第二个红框内把第一个红框的内容复制一遍就ok，具体的配置我也不了解为啥。"><a href="#Step4-注意这里部分的配置，这里是确定代码同步到服务器的目录结构，点击最右侧”…”直接在弹窗中选择即可。第二个红框内把第一个红框的内容复制一遍就ok，具体的配置我也不了解为啥。" class="headerlink" title="Step4. 注意这里部分的配置，这里是确定代码同步到服务器的目录结构，点击最右侧”…”直接在弹窗中选择即可。第二个红框内把第一个红框的内容复制一遍就ok，具体的配置我也不了解为啥。"></a>Step4. 注意这里部分的配置，这里是确定代码同步到服务器的目录结构，点击最右侧”…”直接在弹窗中选择即可。第二个红框内把第一个红框的内容复制一遍就ok，具体的配置我也不了解为啥。</h3><p><img src="/2023/08/01/skill_record/use-pycharm-connect-server/4.png" alt="image"></p>
<h1 id="Git操作三板斧"><a href="#Git操作三板斧" class="headerlink" title="Git操作三板斧"></a><span id="git">Git操作三板斧</span></h1><ol>
<li>拉去<code>git clone xxx</code></li>
<li>查看所有分支: <code>git branch --all</code></li>
<li>在本地拉取某一个远程分支: <code>git checkout -b 本地分支名 远程分支名</code></li>
<li>push: <code>git push origin HEAD:MultiLabelClassification</code></li>
</ol>
<h1 id="StanfordCoreNLP工具启动命令"><a href="#StanfordCoreNLP工具启动命令" class="headerlink" title="StanfordCoreNLP工具启动命令"></a><span id="corenlp">StanfordCoreNLP工具启动命令</span></h1><p><code>java -Xmx4g -cp &quot;/home/stanford-corenlp-full-2018-10-05/*&quot; edu.stanford.nlp.pipeline.StanfordCoreNLPServer -port 8866</code></p>
<p><br></p>
<h4 id="通过Docker"><a href="#通过Docker" class="headerlink" title="通过Docker"></a>通过Docker</h4><p>Dockerfile编写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk</span><br><span class="line">WORKDIR /dd</span><br><span class="line">ADD . /dd</span><br><span class="line">CMD [&quot;java&quot;, &quot;-Xmx8g&quot;, &quot;-cp&quot; ,&quot;*&quot; ,&quot;edu.stanford.nlp.pipeline.StanfordCoreNLPServer&quot; ,&quot;-port&quot; ,&quot;8866&quot;]</span><br></pre></td></tr></table></figure>
<h5 id="build"><a href="#build" class="headerlink" title="build"></a>build</h5><p><code>docker build /home/stanford-corenlp-full-2018-10-05/ -t stanfordcorenlp_chinese:v3.9.2</code></p>
<h5 id="run"><a href="#run" class="headerlink" title="run"></a>run</h5><ul>
<li><code>docker run -itd -p 8866:8866 --name stanfordcorenlp_chinese_container stanfordcorenlp_chinese:v3.9.2</code></li>
<li><code>docker run -itd -p 8866:8866 --net host --name stanfordcorenlp_chinese_container stanfordcorenlp_chinese:v3.9.2</code></li>
</ul>
<h1 id="ElasticSearch踩坑"><a href="#ElasticSearch踩坑" class="headerlink" title="ElasticSearch踩坑"></a><span id="ES_try">ElasticSearch踩坑</span></h1><p>大概是官网：<a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/elasticsearch</a></p>
<h2 id="一些链接："><a href="#一些链接：" class="headerlink" title="一些链接："></a>一些链接：</h2><ul>
<li>MongoDB-Elasticsearch 实时数据导入：<a href="https://zhuanlan.zhihu.com/p/26906652" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/26906652</a></li>
<li>搭建ElasticSearch+MongoDB检索系统：<a href="https://www.cnblogs.com/jamespei/p/5694495.html" target="_blank" rel="noopener">https://www.cnblogs.com/jamespei/p/5694495.html</a></li>
<li>Elasticsearch 权威指南（中文版）：<a href="https://es.xiaoleilu.com/" target="_blank" rel="noopener">https://es.xiaoleilu.com/</a> <a href="/uploads/25f3cdae1cd6b4b966c202c410e7e3ba/elasticsearch-the-definitive-guide-cn.pdf">elasticsearch-the-definitive-guide-cn.pdf</a></li>
</ul>
<p>其他回答：</p>
<ul>
<li>elasticsearch（lucene）可以代替NoSQL（mongodb）吗？：<a href="https://www.zhihu.com/question/25535889" target="_blank" rel="noopener">https://www.zhihu.com/question/25535889</a></li>
<li>终于有人把Elasticsearch原理讲透了！：<a href="https://zhuanlan.zhihu.com/p/62892586" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/62892586</a></li>
<li>ElasticSearch之排序使用-ES常用排序方法：<a href="https://blog.csdn.net/kjsoftware/article/details/76292911" target="_blank" rel="noopener">https://blog.csdn.net/kjsoftware/article/details/76292911</a></li>
<li>Elasticsearch系列六：ES中的倒排索引：<a href="https://lanffy.github.io/2019/05/10/Inverted-Index-In-Elasticsearch" target="_blank" rel="noopener">https://lanffy.github.io/2019/05/10/Inverted-Index-In-Elasticsearch</a></li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="Windows下安装"><a href="#Windows下安装" class="headerlink" title="Windows下安装"></a>Windows下安装</h3><ol>
<li>去官网下载并解压缩</li>
<li>双击执行 elasticsearch.bat，稍等片刻，打开浏览器，输入 <a href="http://localhost:9200" target="_blank" rel="noopener">http://localhost:9200</a> ，显式以下画面，说明ES安装成功：<br><img src="/2023/08/01/skill_record/ElasticSearch踩坑/1.png" alt="image"></li>
<li>安装head插件，此处有坑，见下一楼详情。</li>
<li>安装kibana，参考：<a href="https://www.elastic.co/guide/cn/kibana/current/windows.html" target="_blank" rel="noopener">https://www.elastic.co/guide/cn/kibana/current/windows.html</a> ，下载以后运行 <code>./bin/kibana.bat</code>，然后访问<code>http://localhost:5601/</code></li>
</ol>
<h3 id="Linux下安装"><a href="#Linux下安装" class="headerlink" title="Linux下安装"></a>Linux下安装</h3><ol>
<li>官网(<a href="https://www.elastic.co/cn/downloads/past-releases#elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/past-releases#elasticsearch</a> )下载并配置，参考楼下坑2</li>
<li>使用docker安装，参考：<a href="https://www.cnblogs.com/jianxuanbing/p/9410800.html" target="_blank" rel="noopener">https://www.cnblogs.com/jianxuanbing/p/9410800.html</a></li>
</ol>
<h2 id="坑"><a href="#坑" class="headerlink" title="坑"></a>坑</h2><h3 id="坑1：-安装head插件"><a href="#坑1：-安装head插件" class="headerlink" title="坑1： 安装head插件"></a>坑1： 安装head插件</h3><p>进入bin目录执行：</p>
<blockquote>
<p><code>plugin install mobz/elasticsearch-head</code></p>
</blockquote>
<p>此处可能报错为：</p>
<p><img src="/2023/08/01/skill_record/ElasticSearch踩坑/2.png" alt="image"></p>
<p>需要执行：</p>
<blockquote>
<p><code>elasticsearch-plugin install mobz/elasticsearch-head</code> </p>
</blockquote>
<p>但是也可能遇到这个错误：</p>
<p><img src="/2023/08/01/skill_record/ElasticSearch踩坑/3.png" alt="image"></p>
<p>因此我们要通过以下操作来安装：</p>
<blockquote>
<p><code>git clone https://github.com/mobz/elasticsearch-head.git</code></p>
</blockquote>
<p>进入该文件夹执行</p>
<blockquote>
<p><code>npm install</code> # 这一步如果卡死了可以中断重新安一下</p>
</blockquote>
<p>然后安装好了以后在此目录执行</p>
<blockquote>
<p><code>npm start</code></p>
</blockquote>
<p>见到如下方式说明成功：</p>
<p><img src="/2023/08/01/skill_record/ElasticSearch踩坑/4.png" alt="image"></p>
<p>在./config/elasticsearch.yml里面新增这句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: &quot;*&quot;</span><br></pre></td></tr></table></figure></p>
<p>接下来修改head/Gruntfile.js，这个js文件在根目录下，Ctrl+F搜索connect关键词找到这个位置并新增红框的那句：</p>
<p><img src="/2023/08/01/skill_record/ElasticSearch踩坑/5.png" alt="image"></p>
<p>然后重启npm以及elasticsearch，出现head出现以下说明成功：</p>
<p><img src="/2023/08/01/skill_record/ElasticSearch踩坑/6.png" alt="image"></p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考:"></a>参考:</h4><ul>
<li><a href="https://my.oschina.net/mengzhang6/blog/1632284" target="_blank" rel="noopener">https://my.oschina.net/mengzhang6/blog/1632284</a></li>
<li><a href="https://blog.csdn.net/qq924862077/article/details/79994565" target="_blank" rel="noopener">https://blog.csdn.net/qq924862077/article/details/79994565</a></li>
<li><a href="https://www.twblogs.net/a/5b7d58662b71770a43deb838" target="_blank" rel="noopener">https://www.twblogs.net/a/5b7d58662b71770a43deb838</a></li>
</ul>
<h4 id="备注："><a href="#备注：" class="headerlink" title="备注："></a>备注：</h4><p>有链接要改<code>head/_site/app.js</code>，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">编辑head/_site/app.js，修改head连接es的地址，将localhost修改为es的IP地址  </span><br><span class="line"># 原配置  </span><br><span class="line">this.base_uri = this.config.base_uri || this.prefs.get(&quot;app-base_uri&quot;) || &quot;http://localhost:9200&quot;;  </span><br><span class="line"># 将localhost修改为ES的IP地址  </span><br><span class="line">this.base_uri = this.config.base_uri || this.prefs.get(&quot;app-base_uri&quot;) || &quot;http://YOUR-ES-IP:9200&quot;;</span><br></pre></td></tr></table></figure>
<p>实际上我修改以后并没有成功，所以我没有改这句</p>
<h3 id="坑2-linux下配置安装-版本7-4-2"><a href="#坑2-linux下配置安装-版本7-4-2" class="headerlink" title="坑2-linux下配置安装-版本7.4.2"></a>坑2-linux下配置安装-版本7.4.2</h3><p>遇到以下问题：</p>
<p><img src="/2023/08/01/skill_record/ElasticSearch踩坑/7.png" alt="image"></p>
<p>参考：<a href="https://blog.51cto.com/xpleaf/2327317" target="_blank" rel="noopener">https://blog.51cto.com/xpleaf/2327317</a></p>
<p>对于问题1，有以下解决方式：</p>
<ul>
<li><p>临时修改：<br><code>ulimit -n 65536</code><br>但是重新登录后就会恢复成默认值了。</p>
</li>
<li><p>永久修改<br>修改<code>/etc/security/limits.conf</code>配置，如下：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop          soft    nofile  65536   # soft表示为超过这个值就会有warnning</span><br><span class="line">hadoop          hadr    nofile  100000  # hard则表示不能超过这个值</span><br></pre></td></tr></table></figure>
<p>对于问题2，有以下解决方式：</p>
<ul>
<li>查看当前值<br><code>sysctl vm.max_map_count</code></li>
<li><p>临时设置<br><code>sysctl -w vm.max_map_count=262144</code><br>但是重启系统后就会失效。</p>
</li>
<li><p>永久性设置<br>修改配置文件<code>/etc/sysctl.conf</code>，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm.max_map_count=262144</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>需要重启后才生效。</p>
<p>对于问题3，有以下解决方式：</p>
<p>在安装目录下<code>elasticsearch-7.3.0\config\elasticsearch.yml</code>，将<code>cluster.initial_master_nodes: [&quot;node-1&quot;]</code>的注释放开，即可解决（实际没有解决）<br>（参考：<a href="http://longlonggo.com/post/436.html）" target="_blank" rel="noopener">http://longlonggo.com/post/436.html）</a></p>
<p>修改<code>discovery.seed_hosts: []</code>成服务器的IP，此错误解决，参考：<a href="https://discuss.elastic.co/t/problems-with-access-to-elasticsearch-form-outside-machine/172450/3" target="_blank" rel="noopener">https://discuss.elastic.co/t/problems-with-access-to-elasticsearch-form-outside-machine/172450/3</a></p>
<h1 id="Docker安装ES"><a href="#Docker安装ES" class="headerlink" title="Docker安装ES"></a><span id="docker_es">Docker安装ES</span></h1><ol>
<li><p>安装</p>
<p> <code>docker pull elasticsearch:6.5.0</code></p>
</li>
<li><p>启动</p>
<p> <code>docker run --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -d elasticsearch:6.5.0</code></p>
</li>
<li><p>安装ik分词器</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/share/elasticsearch/plugins/</span><br><span class="line">elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.5.0/elasticsearch-analysis-ik-6.5.0.zip</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">docker restart elasticsearch</span><br></pre></td></tr></table></figure>
</li>
<li><p>docker安装kibana</p>
<ol>
<li>安装：<code>docker pull kibana:7.2.0</code></li>
<li><p>启动</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --name kibana --link=elasticsearch:test  -p 5601:5601 -d kibana:7.2.0</span><br><span class="line">docker start kibana</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<p>问题记录：</p>
<p>出现一种情况：</p>
<p>在DL5通过docker部署的ES，在DL4上无法用python访问（DL5正常），但能够通过<code>curl</code>请求，经过一系列测试发现，用：<code>Elasticsearch(hosts=[{&quot;host&quot;: &#39;xxx&#39;, &quot;port&quot;: 9200}])</code>可以链接，用<code>Elasticsearch(hosts=[{&quot;host&quot;: &#39;xxx&#39;, &quot;port&quot;: 9200}]), sniff_on_start=True, sniff_on_connection_fail=True,sniff_timeout=60)</code>就不可以</p>
<h1 id="服务器通过docker部署brat"><a href="#服务器通过docker部署brat" class="headerlink" title="服务器通过docker部署brat"></a><span id="server_docker_brat">服务器通过docker部署brat</span></h1><ol>
<li>拉取镜像：<code>docker pull cassj/brat</code></li>
<li><p>启动：<code>docker run -itd --name brat_20210113 -p 8867:80 -e BRAT_USERNAME=&quot;brat&quot; -e BRAT_PASSWORD=&quot;brat&quot; -e BRAT_EMAIL=&quot;brat@mark.com&quot; -v /home/research/nlp/brat_20210113:/bratdata cassj/brat</code></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">brat:</span><br><span class="line">image: mark/brat:$VERSION</span><br><span class="line">restart: always</span><br><span class="line">environment:</span><br><span class="line">    - BRAT_USERNAME=brat</span><br><span class="line">    - BRAT_PASSWORD=brat</span><br><span class="line">    - BRAT_EMAIL=brat@mark.com</span><br><span class="line">volumes:</span><br><span class="line">    - brat-data:/bratdata</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="Docker使用速成"><a href="#Docker使用速成" class="headerlink" title="Docker使用速成"></a><span id="docker">Docker使用速成</span></h1><ol>
<li>安装docker<code>sudo apt-get install docker.io</code></li>
<li>拉取所需镜像<code>docker pull ubuntu</code>，搜索所需镜像使用：<code>docker search ubuntu</code>，注意OFFICIAL</li>
<li>编写<code>Dockerfile</code>以及<code>requirement.txt</code></li>
<li>创建修改的镜像<code>sudo docker build /home/similarity_docker/ -t similarity-docker</code>。这里similarity-docker是创建的镜像的名。</li>
<li>打包<code>docker save -o similarity-docker.tar similarity-docker</code>，这里使用的是第四步创建的镜像。</li>
<li>copy到服务器</li>
<li>解压/加载<code>docker load -i similarity-docker.tar</code></li>
<li>跑服务<code>sudo docker run -itd -p 8869:8869 --name sim-docker similarity-docker</code></li>
</ol>
<p><strong>注：如果是深度学习相关需要用<code>nvidia-docker</code></strong></p>
<h4 id="追加重启"><a href="#追加重启" class="headerlink" title="追加重启"></a>追加重启</h4><p><code>docker container update --restart=always 容器名字</code></p>
<h4 id="使用gpu"><a href="#使用gpu" class="headerlink" title="使用gpu"></a>使用gpu</h4><p><code>--gpus all</code></p>
<h4 id="查询依赖"><a href="#查询依赖" class="headerlink" title="查询依赖"></a>查询依赖</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image inspect --format=&apos;&#123;&#123;.RepoTags&#125;&#125; &#123;&#123;.Id&#125;&#125; &#123;&#123;.Parent&#125;&#125;&apos; $(docker image ls -q --filter since=XXX)</span><br></pre></td></tr></table></figure>
<p>XXX指镜像ID</p>
<h4 id="查看Container的IP"><a href="#查看Container的IP" class="headerlink" title="查看Container的IP"></a>查看Container的IP</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect -f &apos;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&apos; container_name_or_id</span><br></pre></td></tr></table></figure>
<h1 id="stanza踩坑"><a href="#stanza踩坑" class="headerlink" title="stanza踩坑"></a><span id="stanza">stanza踩坑</span></h1><blockquote>
<p>Stanza is a collection of accurate and efficient tools for the linguistic analysis of many human languages. Starting from raw text to syntactic analysis and entity recognition, Stanza brings state-of-the-art NLP models to languages of your choosing.</p>
</blockquote>
<h4 id="中文模型下载："><a href="#中文模型下载：" class="headerlink" title="中文模型下载："></a>中文模型下载：</h4><ul>
<li><a href="http://nlp.stanford.edu/software/stanza/1.2.0/zh-hans/default.zip" target="_blank" rel="noopener">http://nlp.stanford.edu/software/stanza/1.2.0/zh-hans/default.zip</a></li>
<li>resources.json： <a href="https://raw.githubusercontent.com/stanfordnlp/stanza-resources/master/resources_1.2.0.json" target="_blank" rel="noopener">https://raw.githubusercontent.com/stanfordnlp/stanza-resources/master/resources_1.2.0.json</a></li>
</ul>
<h4 id="存放路径："><a href="#存放路径：" class="headerlink" title="存放路径："></a>存放路径：</h4><p><img src="/2023/08/01/skill_record/stanza_1.png" alt="image"></p>
<h4 id="调用示例："><a href="#调用示例：" class="headerlink" title="调用示例："></a>调用示例：</h4><p><img src="/2023/08/01/skill_record/stanza_2.png" alt="image"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d = nlp_handle(&quot;第二十五条电网企业负责对分布式光伏发电项目的全部发电量、上网电量分别计量，免费提供并安装电能计量表，不向项目单位收取系统备用容量费。电网企业在有关并网接入和运行等所有环节提供的服务均不向项目单位收取费用。&quot;)</span><br><span class="line">&gt;&gt;&gt; dir(d)</span><br><span class="line">[&apos;__class__&apos;, &apos;__delattr__&apos;, &apos;__dict__&apos;, &apos;__dir__&apos;, &apos;__doc__&apos;, &apos;__eq__&apos;, &apos;__format__&apos;, &apos;__ge__&apos;, &apos;__getattribute__&apos;, &apos;__gt__&apos;, &apos;__hash__&apos;, &apos;__init__&apos;, &apos;__init_subclass__&apos;, &apos;__le__&apos;, &apos;__lt__&apos;, &apos;__module__&apos;, &apos;__ne__&apos;, &apos;__new__&apos;, &apos;__reduce__&apos;, &apos;__reduce_ex__&apos;, &apos;__repr__&apos;, &apos;__setattr__&apos;, &apos;__sizeof__&apos;, &apos;__str__&apos;, &apos;__subclasshook__&apos;, &apos;__weakref__&apos;, &apos;_ents&apos;, &apos;_num_tokens&apos;, &apos;_num_words&apos;, &apos;_process_sentences&apos;, &apos;_sentences&apos;, &apos;_text&apos;, &apos;add_property&apos;, &apos;build_ents&apos;, &apos;entities&apos;, &apos;ents&apos;, &apos;from_serialized&apos;, &apos;get&apos;, &apos;get_mwt_expansions&apos;, &apos;iter_tokens&apos;, &apos;iter_words&apos;, &apos;num_tokens&apos;, &apos;num_words&apos;, &apos;sentences&apos;, &apos;set&apos;, &apos;set_mwt_expansions&apos;, &apos;text&apos;, &apos;to_dict&apos;, &apos;to_serialized&apos;]</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h1 id="lt-span-id-”mongodb-gt-MongoDB踩坑-lt-span-gt"><a href="#lt-span-id-”mongodb-gt-MongoDB踩坑-lt-span-gt" class="headerlink" title="&lt;span id=”mongodb&gt;MongoDB踩坑&lt;/span&gt;"></a>&lt;span id=”mongodb&gt;MongoDB踩坑&lt;/span&gt;</h1><h4 id="安装MongoDB"><a href="#安装MongoDB" class="headerlink" title="安装MongoDB"></a>安装MongoDB</h4><ol>
<li><p>windows</p>
<ol>
<li>访问<a href="https://www.mongodb.com/download-center/community" target="_blank" rel="noopener">https://www.mongodb.com/download-center/community</a> ，选择所需版本，我使用了Community版本，因为不用登录</li>
<li>安装刚刚下载的包，建议选择<code>custom</code>，然后在接下来的步骤中<code>安装MongoDB Compass</code>选项去掉，因为没有梯子可能会卡死，compass是一个可视化界面，可以后续通过<a href="https://www.mongodb.com/products/compass" target="_blank" rel="noopener">https://www.mongodb.com/products/compass</a> 下载安装</li>
</ol>
</li>
<li><p>Linux服务器</p>
<ol>
<li>去<a href="https://www.mongodb.org/dl/linux/x86_64" target="_blank" rel="noopener">https://www.mongodb.org/dl/linux/x86_64</a> 选择一个合适的版本wget到服务器（以我下载的mongodb-linux-x86_64-rhel62-v4.2-latest.tgz为例）</li>
<li>解压：<code>tar -xvzf mongodb-linux-x86_64-rhel62-v4.2-latest.tgz</code>，并将此文件夹改名为<code>MongoDB</code></li>
<li>新建文件夹：data, log, conf，在data文件夹中新建一<code>db</code>文件夹</li>
<li>进入conf文件夹新建一<code>mongodb.conf</code>进行配置，<img src="/2023/08/01/skill_record/MongoDB踩坑/1.png" alt="image"><br>主要设置这几个参数，最后一个<code>fork</code>参数是指是否以后台运行</li>
</ol>
</li>
</ol>
<h4 id="启动MongoDB服务"><a href="#启动MongoDB服务" class="headerlink" title="启动MongoDB服务"></a>启动MongoDB服务</h4><ol>
<li><p>Windows</p>
<p> 待补充，打开compass连接默认数据库就启动了，以后也会随电脑自启动</p>
</li>
<li><p>Linux服务器</p>
<p> <code>./bin/mongod -f ./conf/mongodb.conf</code> </p>
<p> 意思是使用bin文件夹中的<code>mongod</code>，并指定使用<code>mongodb.conf</code>配置文件进行运行，看到successfully即表示运行成功</p>
<p> 也可以通过命令行的方式：</p>
<pre><code> `mongod --dbpath d:/mongodb/data/data  --port 27137 --logpath d:/mongodb/logs --logappend `
</code></pre></li>
</ol>
<h4 id="进入MongoDB后台"><a href="#进入MongoDB后台" class="headerlink" title="进入MongoDB后台"></a>进入MongoDB后台</h4><ol>
<li><p>Windows</p>
<p> 请用compass</p>
</li>
<li><p>Linux服务器</p>
<p> <code>./bin/mongo --port xxxx</code></p>
<p> 此处有2坑。</p>
<pre><code>1. 这里执行的是bin文件夹的`mongo`与上一步的`mongod`差一个字母
2. 如果没有使用默认的端口，此处进去后台需要指定*.conf中的端口，否则找不到
</code></pre></li>
</ol>
<h4 id="基础MongoDB后台命令"><a href="#基础MongoDB后台命令" class="headerlink" title="基础MongoDB后台命令"></a>基础MongoDB后台命令</h4><ul>
<li><p>创建数据库</p>
<p>  <code>use DATABASE_NAME</code> 如果数据库不存在，则创建数据库，否则切换到指定数据库。</p>
</li>
<li><p>查看所有数据库</p>
<p>  <code>show dbs</code> 注意，如果新创建了数据库但是没有插入数据，这里是不会显示的</p>
</li>
<li><p>查看某数据库下所有collection</p>
<p>  <code>show collections</code></p>
</li>
<li><p>查看当前在哪个数据库上操作</p>
<p>  <code>db</code></p>
</li>
<li><p>删除当前所在的数据库</p>
<p>  <code>db.dropDatabase()</code></p>
</li>
<li><p>创建collection</p>
<ul>
<li>隐式创建：<code>db.my_coll.insert({&#39;test&#39;:&#39;11&#39;})</code></li>
<li>显式创建：<code>db.creatCollection(&#39;my_coll)</code></li>
</ul>
</li>
</ul>
<h4 id="pymongo"><a href="#pymongo" class="headerlink" title="pymongo"></a>pymongo</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># import</span><br><span class="line">from pymongo import MongoClient </span><br><span class="line"></span><br><span class="line"># 连接库，注意需要启动服务并保证端口准确</span><br><span class="line">client = MongoClient(&apos;mongodb://localhost:27017&apos;) </span><br><span class="line"></span><br><span class="line"># 选择其中一个数据库，如果没有则新建（类似于`use Material`）</span><br><span class="line">db = client.Material </span><br><span class="line"></span><br><span class="line"># 获取所有collection名称</span><br><span class="line">colls = db.list_collection_names()</span><br><span class="line"></span><br><span class="line"># 选择其中一个集合，如果没有则新建（类似于`db.createCollection()`）</span><br><span class="line">coll_act = db.articles </span><br><span class="line"></span><br><span class="line"># 插入数据——一次性插入多个</span><br><span class="line"># ordered参数指示如果遇到异常是否继续，True为当场退出</span><br><span class="line"># 有网友说一次只能插入1000条，但是我测试好像没有这个问题</span><br><span class="line">coll_act.insert_many(lst, ordered=False) </span><br><span class="line"></span><br><span class="line"># 插入数据——一次插入一个</span><br><span class="line">coll_act.insert_one(&#123;&apos;test&apos;: &apos;t&apos;&#125;)</span><br><span class="line"></span><br><span class="line"># 查找数据，返回的是cursor，可以使用np.array()或者pd.DataFrame()转</span><br><span class="line">tmp = np.array(list(coll_act.find(&#123;&#125;, &#123;&apos;vector&apos;: 1, &apos;_id&apos;: 0&#125;) # 1表示选择这个字段，无论如何都会返回_id，因此此字段置为0。注意，find里面有两个大括号</span><br><span class="line">tmp = pd.DataFrame(list(coll_act.find())) # 这个很好使，注意先要转化为list</span><br><span class="line"></span><br><span class="line"># 查找——select article, array FROM col WHERE _id=ObjectId(&quot;&quot;)</span><br><span class="line">from bson.objectid import ObjectId</span><br><span class="line">coll_act.find(&#123;&apos;_id&apos;: ObjectId(file_id)&#125;,  &#123;&apos;article_id&apos;: 1, &apos;vector&apos;: 1&#125;)</span><br><span class="line"></span><br><span class="line"># 关闭client</span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<h1 id="paddle框架踩坑"><a href="#paddle框架踩坑" class="headerlink" title="paddle框架踩坑"></a><span id="paddle">paddle框架踩坑</span></h1><h4 id="相关链接："><a href="#相关链接：" class="headerlink" title="相关链接："></a>相关链接：</h4><ul>
<li>官网：<a href="https://www.paddlepaddle.org.cn/" target="_blank" rel="noopener">https://www.paddlepaddle.org.cn/</a></li>
<li>Github：<a href="https://github.com/paddlepaddle/paddle" target="_blank" rel="noopener">https://github.com/paddlepaddle/paddle</a></li>
<li>文档：<a href="https://www.paddlepaddle.org.cn/documentation/docs/zh/guides/index_cn.html" target="_blank" rel="noopener">https://www.paddlepaddle.org.cn/documentation/docs/zh/guides/index_cn.html</a></li>
</ul>
<h4 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h4><blockquote>
<p>飞桨(PaddlePaddle)以百度多年的深度学习技术研究和业务应用为基础，是中国首个开源开放、技术领先、功能完备的产业级深度学习平台，集深度学习核心训练和推理框架、基础模型库、端到端开发套件和丰富的工具组件于一体。目前，飞桨已凝聚超265万开发者，服务企业10万家，基于飞桨开源深度学习平台产生了34万个模型   。飞桨助力开发者快速实现AI想法，快速上线AI业务。帮助越来越多的行业完成AI赋能，实现产业智能化升级。</p>
</blockquote>
<h4 id="开源项目："><a href="#开源项目：" class="headerlink" title="开源项目："></a>开源项目：</h4><h5 id="1-PaddleGAN"><a href="#1-PaddleGAN" class="headerlink" title="1. PaddleGAN"></a>1. <a href="https://github.com/PaddlePaddle/PaddleGAN/blob/develop/README_cn.md" target="_blank" rel="noopener">PaddleGAN</a></h5><p>生成对抗网络开发套件—PaddleGAN，为开发者提供经典及前沿的生成对抗网络高性能实现，并支撑开发者快速构建、训练及部署生成对抗网络，以供学术、娱乐及产业应用，包含以下内容：</p>
<ul>
<li>图片变换</li>
<li>老视频修复</li>
<li>动作迁移</li>
<li>超分辨率</li>
<li>妆容迁移 </li>
<li>人脸动漫化 </li>
<li>写实人像卡通化</li>
<li>照片动漫化</li>
<li>唇形同步</li>
</ul>
<h5 id="2-PaddleDetection"><a href="#2-PaddleDetection" class="headerlink" title="2. PaddleDetection"></a>2. <a href="https://github.com/PaddlePaddle/PaddleDetection" target="_blank" rel="noopener">PaddleDetection</a></h5><p>飞桨目标检测开发套件，旨在帮助开发者更快更好地完成检测模型的组建、训练、优化及部署等全开发流程。</p>
<p>PaddleDetection模块化地实现了多种主流目标检测算法，提供了丰富的数据增强策略、网络模块组件（如骨干网络）、损失函数等，并集成了模型压缩和跨平台高性能部署能力。</p>
<p>模型库</p>
<ul>
<li>通用目标检测:<ul>
<li>模型库和基线]</li>
<li>移动端模型</li>
<li>Anchor Free</li>
<li>PP-YOLO模型]</li>
<li>676类目标检测</li>
<li>两阶段实用模型PSS-Det</li>
</ul>
</li>
<li>通用实例分割：<ul>
<li>SOLOv2</li>
</ul>
</li>
<li>垂类领域<ul>
<li>人脸检测</li>
<li>行人检测</li>
<li>车辆检测</li>
</ul>
</li>
</ul>
<p>应用案例</p>
<ul>
<li>人像圣诞特效自动生成工具</li>
</ul>
<h5 id="3-PaddleNLP"><a href="#3-PaddleNLP" class="headerlink" title="3. PaddleNLP"></a>3. <a href="https://github.com/PaddlePaddle/PaddleNLP" target="_blank" rel="noopener">PaddleNLP</a></h5><blockquote>
<p>PaddleNLP 2.0拥有覆盖多场景的模型库、简洁易用的全流程API与动静统一的高性能分布式训练能力，旨在为飞桨开发者提升文本领域建模效率，并提供基于PaddlePaddle 2.0的NLP领域最佳实践。</p>
</blockquote>
<p>模型库及其应用</p>
<p>PaddleNLP模型库整体介绍请参考文档<a href="./docs/model_zoo.md">PaddleNLP Model Zoo</a>。<br>模型应用场景介绍请参考<a href="./examples/">PaddleNLP Examples</a>。</p>
<ul>
<li>词向量</li>
<li>词法分析</li>
<li>命名实体识别</li>
<li>语言模型</li>
<li>文本分类</li>
<li>文本生成</li>
<li>语义匹配</li>
<li>文本图学习</li>
<li>通用对话</li>
<li>机器翻译</li>
<li>阅读理解</li>
</ul>
<h5 id="4-PaddleClas"><a href="#4-PaddleClas" class="headerlink" title="4. PaddleClas"></a>4. <a href="https://github.com/PaddlePaddle/PaddleClas/blob/release/2.0/README_cn.md" target="_blank" rel="noopener">PaddleClas</a></h5><p>图像分类套件PaddleClas是飞桨为工业界和学术界所准备的一个图像分类任务的工具集，助力使用者训练出更好的视觉模型和应用落地。</p>
<p><a href="./docs/zh_CN/models/models_intro.md">模型库介绍和预训练模型</a></p>
<ul>
<li>SSLD知识蒸馏系列</li>
<li>ResNet及其Vd系列</li>
<li>移动端系列</li>
<li>SEResNeXt与Res2Net系列</li>
<li>DPN与DenseNet系列</li>
<li>HRNet</li>
<li>Inception系列</li>
<li>EfficientNet与ResNeXt101_wsl系列</li>
<li>ResNeSt与RegNet系列</li>
<li>HS-ResNet: arxiv文章链接: <a href="https://arxiv.org/pdf/2010.07621.pdf" target="_blank" rel="noopener">https://arxiv.org/pdf/2010.07621.pdf</a>。 代码和预训练模型即将开源，敬请期待。</li>
</ul>
<h5 id="5-DeepSpeech"><a href="#5-DeepSpeech" class="headerlink" title="5. DeepSpeech"></a>5. <a href="https://github.com/PaddlePaddle/DeepSpeech/blob/release/v1.8.5/README_cn.md" target="_blank" rel="noopener">DeepSpeech</a></h5><p><em>DeepSpeech2</em>是一个采用<a href="https://github.com/PaddlePaddle/Paddle" target="_blank" rel="noopener">PaddlePaddle</a>平台的端到端自动语音识别（ASR）引擎的开源项目，具体原理参考这篇论文<a href="http://proceedings.mlr.press/v48/amodei16.pdf" target="_blank" rel="noopener">Baidu’s Deep Speech 2 paper</a>。<br>我们的愿景是为语音识别在工业应用和学术研究上，提供易于使用、高效和可扩展的工具，包括训练，推理，测试模块，以及 demo 部署。同时，我们还将发布一些预训练好的英语和普通话模型。</p>
<h5 id="6-PaddleOCR"><a href="#6-PaddleOCR" class="headerlink" title="6. PaddleOCR"></a>6. <a href="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.0/README_ch.md" target="_blank" rel="noopener">PaddleOCR</a></h5><p>PaddleOCR旨在打造一套丰富、领先、且实用的OCR工具库，助力使用者训练出更好的模型，并应用落地。</p>
<ul>
<li>算法介绍<ul>
<li>文本检测</li>
<li>文本识别</li>
</ul>
</li>
<li>模型训练/评估<ul>
<li>文本检测</li>
<li>文本识别</li>
<li>方向分类器</li>
</ul>
</li>
</ul>
<h5 id="7-PaddleSlim"><a href="#7-PaddleSlim" class="headerlink" title="7. PaddleSlim"></a>7. <a href="https://github.com/PaddlePaddle/PaddleSlim" target="_blank" rel="noopener">PaddleSlim</a></h5><p>PaddleSlim是一个专注于深度学习模型压缩的工具库，提供剪裁、量化、蒸馏、和模型结构搜索等模型压缩策略，帮助用户快速实现模型的小型化。</p>
<h5 id="8-PaddleRec"><a href="#8-PaddleRec" class="headerlink" title="8. PaddleRec"></a>8. <a href="https://github.com/PaddlePaddle/PaddleRec" target="_blank" rel="noopener">PaddleRec</a></h5><ul>
<li>源于飞桨生态的搜索推荐模型 一站式开箱即用工具</li>
<li>适合初学者，开发者，研究者的推荐系统全流程解决方案</li>
<li>包含内容理解、匹配、召回、排序、 多任务、重排序等多个任务的完整推荐搜索算法库</li>
</ul>
<h5 id="9-PaddleSeg"><a href="#9-PaddleSeg" class="headerlink" title="9. PaddleSeg"></a>9. <a href="https://github.com/PaddlePaddle/PaddleSeg/blob/release/v2.0/README_CN.md" target="_blank" rel="noopener">PaddleSeg</a></h5><p>PaddleSeg是基于飞桨PaddlePaddle开发的端到端图像分割开发套件，涵盖了高精度和轻量级等不同方向的大量高质量分割模型。通过模块化的设计，提供了配置化驱动和API调用两种应用方式，帮助开发者更便捷地完成从训练到部署的全流程图像分割应用。</p>
<p>特性</p>
<ul>
<li>高精度模型：基于百度自研的半监督标签知识蒸馏方案（SSLD）训练得到高精度骨干网络，结合前沿的分割技术，提供了50+的高质量预训练模型，效果优于其他开源实现。</li>
<li>模块化设计：支持15+主流 分割网络 ，结合模块化设计的 数据增强策略 、骨干网络、损失函数 等不同组件，开发者可以基于实际应用场景出发，组装多样化的训练配置，满足不同性能和精度的要求。</li>
<li>高性能：支持多进程异步I/O、多卡并行训练、评估等加速策略，结合飞桨核心框架的显存优化功能，可大幅度减少分割模型的训练开销，让开发者更低成本、更高效地完成图像分割训练。</li>
</ul>
<h5 id="10-Paddle-Graph-Learning"><a href="#10-Paddle-Graph-Learning" class="headerlink" title="10. Paddle Graph Learning"></a>10. <a href="https://github.com/PaddlePaddle/PGL/blob/main/README.zh.md" target="_blank" rel="noopener">Paddle Graph Learning</a></h5><p>一个基于PaddlePaddle的高效易用的图学习框架</p>
<h5 id="11-Parakeet"><a href="#11-Parakeet" class="headerlink" title="11. Parakeet"></a>11. <a href="https://github.com/PaddlePaddle/Parakeet" target="_blank" rel="noopener">Parakeet</a></h5><p>Parakeet aims to provide a flexible, efficient and <strong>state-of-the-art text-to-speech toolkit</strong> for the open-source community. It is built on PaddlePaddle Fluid dynamic graph and includes many influential TTS models proposed by Baidu Research and other research groups.</p>
<h4 id="paddle优势-amp-劣势"><a href="#paddle优势-amp-劣势" class="headerlink" title="paddle优势&amp;劣势"></a>paddle优势&amp;劣势</h4><ul>
<li>社区活跃，开源了众多的项目和代码，文档质量不错</li>
<li>有活动提供一些免费的算力</li>
<li>现有论文代码主要以tf和torch居多，以paddle开源的较少</li>
</ul>
<h4 id="具体尝试"><a href="#具体尝试" class="headerlink" title="具体尝试"></a>具体尝试</h4><p>安装：<code>conda install paddlepaddle-gpu==2.1.1 cudatoolkit=11.2 -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/Paddle/ -c conda-forge</code></p>
<ol>
<li>PaddleNLP Embedding API<a href="https://github.com/PaddlePaddle/PaddleNLP/blob/develop/docs/model_zoo/embeddings.md" target="_blank" rel="noopener">链接</a></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> paddle</span><br><span class="line"><span class="keyword">from</span> paddlenlp.embeddings <span class="keyword">import</span> TokenEmbedding, list_embedding_name</span><br><span class="line">paddle.set_device(<span class="string">"cpu"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看预训练embedding名称：</span></span><br><span class="line">print(list_embedding_name())</span><br><span class="line"><span class="comment"># ['w2v.baidu_encyclopedia.target.word-word.dim300']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化TokenEmbedding， 预训练embedding没下载时会自动下载并加载数据</span></span><br><span class="line">token_embedding = TokenEmbedding(embedding_name=<span class="string">"w2v.baidu_encyclopedia.target.word-word.dim300"</span>)</span><br><span class="line"></span><br><span class="line">score = token_embedding.cosine_sim(<span class="string">"中国"</span>, <span class="string">"美国"</span>)</span><br><span class="line">print(score) <span class="comment"># 0.49586025</span></span><br></pre></td></tr></table></figure>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/踩坑/">踩坑</a>
  </div>

</div>



</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/2023/08/22/NL2SQL任务简介/" title="【NL2SQL】任务简介">
  <span>
  【NL2SQL】任务简介</span>
</a>
</div>


<div class="next">
<a href="/2023/03/01/PLM瞎扯/" title="PLM瞎扯">
 <span>PLM瞎扯
</span>
</a>
</div>

</nav>

	

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">
<div id="authorInfo">
	
		<div class="author-img"></div>		
	
	<div class="social-info">
		
		
		
		
		
		
		
		
		
		
		
		<a href="mailto:candnes@sina.com" target="_blank" class="icon-email" title="Email Me"></a>
		

	</div>
</div>

  

  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/NLP/" title="NLP">NLP<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/Coreference-Resolution/" title="Coreference Resolution">Coreference Resolution<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/NL2SQL/" title="NL2SQL">NL2SQL<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/学习/" title="学习">学习<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/踩坑/" title="踩坑">踩坑<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/爬虫/" title="爬虫">爬虫<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/多模态/" title="多模态">多模态<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/GNN/" title="GNN">GNN<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer">
		
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/hsihohuang/kiddochan" target="_blank" title="Kiddochan">Kiddochan</a> © 2023 
		
		<a href="/about" target="_blank" title="Yuanqing Zhu">Yuanqing Zhu</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
